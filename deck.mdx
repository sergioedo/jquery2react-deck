import {
  CodeSurfer,
  CodeSurferColumns,
  Step,
} from "code-surfer";
import { github, vsDark } from "@code-surfer/themes";

export const theme = vsDark;

# Aprendiendo ‚öõÔ∏èReact

### Desaprendiendo üí≤JQuery

-- Reactionarios de [Web Reactiva](https://www.webreactiva.com/) --

---

### 1. Selecci√≥n de Personajes

<iframe
  width="80%"
  height="50%"
  src="https://jquery2react-4c55pokc5-sergioedo.vercel.app/"
/>

---

<CodeSurfer>

```js title="Version est√°tica, no reactiva"
import "./App.css";

const App = () => {
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>
      <div>
        <label>Elige un personaje:</label>
        <select id="character">
          <option value="13.5">Jon Snow (13.5‚Ç¨)</option>
          <option value="16.5">
            Danerys Targaryen (16.5‚Ç¨)
          </option>
          <option value="19">Tyrion Lannister (19‚Ç¨)</option>
        </select>
      </div>
      <div id="result">
        Precio total: <span id="total">13.50‚Ç¨</span>
      </div>
    </>
  );
};
```

```diff 6:19 subtitle="JSX es casi puro HTML"

```

```js title="A√±adimos estado + evento con setState"
import { useState } from "react";
import "./App.css";

const App = () => {
  const [totalValue, setTotalValue] = useState(13.5);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          id="character"
          onChange={(e) =>
            setTotalValue(Number(e.target.value))
          }
        >
          <option value="13.5">Jon Snow (13.5‚Ç¨)</option>
          <option value="16.5">
            Danerys Targaryen (16.5‚Ç¨)
          </option>
          <option value="19">Tyrion Lannister (19‚Ç¨)</option>
        </select>
      </div>

      <div id="result">
        Precio total:{" "}
        <span id="total">{totalValue.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

</CodeSurfer>

---

### 2. Opci√≥n de dragon extra

<iframe
  width="80%"
  height="50%"
  src="https://jquery2react-4gn66b207-sergioedo.vercel.app/"
/>

---

<CodeSurfer>

```js title="Personajes 'data driven'"
import { useState } from "react";
import "./App.css";

const App = () => {
  const [totalValue, setTotalValue] = useState(13.5);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>
      <div>
        <label>Elige un personaje:</label>
        <select
          id="character"
          onChange={(e) =>
            setTotalValue(Number(e.target.value))
          }
        >
          <option value="13.5">Jon Snow (13.5‚Ç¨)</option>
          <option value="16.5">
            Danerys Targaryen (16.5‚Ç¨)
          </option>
          <option value="19">Tyrion Lannister (19‚Ç¨)</option>
        </select>
      </div>
      <div>
        Precio total: <span>{totalValue.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js
import { useState } from "react";
import "./App.css";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];

const App = () => {
  const [totalValue, setTotalValue] = useState(13.5);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>
      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setTotalValue(Number(e.target.value))
          }
        >
          {characters.map((character) => {
            return (
              <option
                key={character.name}
                value={character.price}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>
      <div>
        Precio total: <span>{totalValue.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js subtitle="√≠ndice de personaje como estado"
import { useState } from "react";
import "./App.css";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const totalValue =
    characters[selectedCharacterIndex].price;
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      <div>
        Precio total: <span>{totalValue.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js subtitle=""
import { useState } from "react";
import "./App.css";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const totalValue =
    selectedCharacter.price +
    (showDragonOption && includeDragon ? DRAGON_PRICE : 0);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      <div
        style={{
          display: showDragonOption ? "block" : "none",
        }}
      >
        <input
          type="checkbox"
          onChange={(e) =>
            setIncludeDragon(e.target.checked)
          }
        />
        <label htmlFor="dragon">
          Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
        </label>
      </div>

      <div>
        Precio total: <span>{totalValue.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```diff 18:24 subtitle="Incluir drag√≥n - mostrar + estado + c√°lculo"

```

```diff 49:63 subtitle="Incluir drag√≥n - mostrar con CSS"

```

```js subtitle="Evitar renderizar --> sincronizar estado"
import { useState } from "react";
import "./App.css";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const totalValue =
    selectedCharacter.price +
    (showDragonOption && includeDragon ? DRAGON_PRICE : 0);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        Precio total: <span>{totalValue.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

</CodeSurfer>

---

### 3. Cantidad de producto

<iframe
  width="80%"
  height="50%"
  src="https://jquery2react-i5oz3trtk-sergioedo.vercel.app/"
/>

---

<CodeSurfer>

```js
import { useState } from "react";
import "./App.css";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const totalValue =
    selectedCharacter.price +
    (showDragonOption && includeDragon ? DRAGON_PRICE : 0);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        Precio total: <span>{totalValue.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js
import { useState } from "react";
import "./App.css";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const totalValue =
    (selectedCharacter.price +
      (showDragonOption && includeDragon
        ? DRAGON_PRICE
        : 0)) *
    quantity;
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Precio total: <span>{totalValue.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```diff 22:29 subtitle="estado + c√°lculo"

```

```diff 69:79 subtitle="componente + valor-estado + evento-setState"

```

</CodeSurfer>

---

### 3. C√°lculo de impuestos

<iframe
  width="80%"
  height="50%"
  src="https://jquery2react-e49obbdu6-sergioedo.vercel.app/"
/>

---

<CodeSurfer>

```js
import { useState } from "react";
import "./App.css";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const totalValue =
    (selectedCharacter.price +
      (showDragonOption && includeDragon
        ? DRAGON_PRICE
        : 0)) *
    quantity;
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Precio total: <span>{totalValue.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js
import { useState, useEffect } from "react";
import "./App.css";

const getRandomCountry = async () => {
  const response = await fetch(
    "https://random-data-api.com/api/v2/addresses"
  );
  const country = await response.json();
  return {
    name: country.country,
    code: country.country_code,
  };
};
const DEFAULT_COUNTRY = {
  name: "Spain",
  code: "ES",
};

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const [country, setCountry] = useState(DEFAULT_COUNTRY);

  useEffect(() => {
    const setInitialCountry = async () => {
      const country = await getRandomCountry();
      setCountry(country);
    };
    setInitialCountry();
  }, []);

  const extraDragon =
    showDragonOption && includeDragon ? DRAGON_PRICE : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const countryLetter = country.name
    .charAt(0)
    .toLowerCase();
  const taxPercentage = ["a", "e", "i", "o", "u"].includes(
    countryLetter
  )
    ? 10
    : 20;
  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```diff 3:17 subtitle="funci√≥n random country + valor por defecto"

```

```diff 39:48 subtitle="estado pais + fetch inicial con useEffect"

```

```diff 54:63 subtitle="c√°lculo de impuestos"

```

```diff 115:125,129[16:34] subtitle="mostramos impuestos + nuevo total"

```

</CodeSurfer>

---

# Patr√≥n de ‚öõÔ∏èReact‚öõÔ∏è

- Estados (useState)
- Efectos (useEffect)
- C√°lculos (Javascript)
- Render (JSX - data driven)

---

# Refactor con ‚öõÔ∏èReact‚öõÔ∏è

- Estados + Efectos + C√°lculos => <ins>**Custom Hook**</ins> <br /> (_useMiCosaDeNegocio()_)
- Render => <ins>**Componentes**</ins> <br />(_<MiCosaDeNegocio /\>_)

---

<CodeSurfer>

```js 38:48 title="Hook useRandomCountry"
import { useState, useEffect } from "react";
import "./App.css";

const getRandomCountry = async () => {
  const response = await fetch(
    "https://random-data-api.com/api/v2/addresses"
  );
  const country = await response.json();
  return {
    name: country.country,
    code: country.country_code,
  };
};
const DEFAULT_COUNTRY = {
  name: "Spain",
  code: "ES",
};

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const [country, setCountry] = useState(DEFAULT_COUNTRY);

  useEffect(() => {
    const setInitialCountry = async () => {
      const country = await getRandomCountry();
      setCountry(country);
    };
    setInitialCountry();
  }, []);

  const extraDragon =
    showDragonOption && includeDragon ? DRAGON_PRICE : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const countryLetter = country.name
    .charAt(0)
    .toLowerCase();
  const taxPercentage = ["a", "e", "i", "o", "u"].includes(
    countryLetter
  )
    ? 10
    : 20;
  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js subtitle="encapsular en funci√≥n useXXXXXX"
import { useState, useEffect } from "react";
import "./App.css";

const getRandomCountry = async () => {
  const response = await fetch(
    "https://random-data-api.com/api/v2/addresses"
  );
  const country = await response.json();
  return {
    name: country.country,
    code: country.country_code,
  };
};
const DEFAULT_COUNTRY = {
  name: "Spain",
  code: "ES",
};

const useRandomCountry = (
  defaultCountry = DEFAULT_COUNTRY
) => {
  const [country, setCountry] = useState(defaultCountry);

  useEffect(() => {
    const setInitialCountry = async () => {
      const country = await getRandomCountry();
      setCountry(country);
    };
    setInitialCountry();
  }, []);

  return { country };
};

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { country } = useRandomCountry();

  const extraDragon =
    showDragonOption && includeDragon ? DRAGON_PRICE : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const countryLetter = country.name
    .charAt(0)
    .toLowerCase();
  const taxPercentage = ["a", "e", "i", "o", "u"].includes(
    countryLetter
  )
    ? 10
    : 20;
  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

</CodeSurfer>

---

<CodeSurferColumns>

<Step subtitle="extracci√≥n a otro fichero">

```js 4:34,54:55
import { useState, useEffect } from "react";
import "./App.css";

const getRandomCountry = async () => {
  const response = await fetch(
    "https://random-data-api.com/api/v2/addresses"
  );
  const country = await response.json();
  return {
    name: country.country,
    code: country.country_code,
  };
};
const DEFAULT_COUNTRY = {
  name: "Spain",
  code: "ES",
};

const useRandomCountry = (
  defaultCountry = DEFAULT_COUNTRY
) => {
  const [country, setCountry] = useState(defaultCountry);

  useEffect(() => {
    const setInitialCountry = async () => {
      const country = await getRandomCountry();
      setCountry(country);
    };
    setInitialCountry();
  }, []);

  return { country };
};

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { country } = useRandomCountry();

  const extraDragon =
    showDragonOption && includeDragon ? DRAGON_PRICE : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const countryLetter = country.name
    .charAt(0)
    .toLowerCase();
  const taxPercentage = ["a", "e", "i", "o", "u"].includes(
    countryLetter
  )
    ? 10
    : 20;
  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js

```

</Step>

<Step>

```js
import { useState } from "react";
import "./App.css";
import useRandomCountry from "./hooks/useRandomCountry";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { country } = useRandomCountry();

  const extraDragon =
    showDragonOption && includeDragon ? DRAGON_PRICE : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const countryLetter = country.name
    .charAt(0)
    .toLowerCase();
  const taxPercentage = ["a", "e", "i", "o", "u"].includes(
    countryLetter
  )
    ? 10
    : 20;
  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js
// file: hooks/useRandomCountry.js

import { useState, useEffect } from "react";

const getRandomCountry = async () => {
  const response = await fetch(
    "https://random-data-api.com/api/v2/addresses"
  );
  const country = await response.json();
  return {
    name: country.country,
    code: country.country_code,
  };
};
const DEFAULT_COUNTRY = {
  name: "Spain",
  code: "ES",
};

const useRandomCountry = (
  defaultCountry = DEFAULT_COUNTRY
) => {
  const [country, setCountry] = useState(defaultCountry);

  useEffect(() => {
    const setInitialCountry = async () => {
      const country = await getRandomCountry();
      setCountry(country);
    };
    setInitialCountry();
  }, []);

  return { country };
};

export default useRandomCountry;
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Hook useTaxes">

```js 25,31:39 subtitle="l√≥gica de impuestos"
import { useState } from "react";
import "./App.css";
import useRandomCountry from "./hooks/useRandomCountry";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { country } = useRandomCountry();

  const extraDragon =
    showDragonOption && includeDragon ? DRAGON_PRICE : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const countryLetter = country.name
    .charAt(0)
    .toLowerCase();
  const taxPercentage = ["a", "e", "i", "o", "u"].includes(
    countryLetter
  )
    ? 10
    : 20;
  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js

```

</Step>

<Step title="Hook useTaxes">

```js
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const extraDragon =
    showDragonOption && includeDragon ? DRAGON_PRICE : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js subtitle="Taxes Team"
// file: hooks/useTaxes.js

import useRandomCountry from "./useRandomCountry";

const useTaxes = () => {
  const { country } = useRandomCountry();
  const countryLetter = country.name
    .charAt(0)
    .toLowerCase();
  const taxPercentage = ["a", "e", "i", "o", "u"].includes(
    countryLetter
  )
    ? 10
    : 20;

  return { taxPercentage, country };
};
export default useTaxes;
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Opci√≥n de drag√≥n">

```js 20,28 subtitle="por √≠ndice"
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  { name: "Danerys Targaryen", price: 16.5 },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const showDragonOption = selectedCharacterIndex === 1;
  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const extraDragon =
    showDragonOption && includeDragon ? DRAGON_PRICE : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {showDragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

```js 10,31 subtitle="por datos"
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  {
    name: "Danerys Targaryen",
    price: 16.5,
    dragonOption: true,
  },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const extraDragon =
    selectedCharacter.dragonOption && includeDragon
      ? DRAGON_PRICE
      : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

</Step>

<Step title="Opci√≥n de drag√≥n">

```diff 58 subtitle="por √≠ndice"

```

```diff 63 subtitle="por datos"

```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Estado selectedCharacter">

```js 17:22
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  {
    name: "Danerys Targaryen",
    price: 16.5,
    dragonOption: true,
  },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [
    selectedCharacterIndex,
    setSelectedCharacterIndex,
  ] = useState(0);
  const selectedCharacter =
    characters[selectedCharacterIndex];

  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const extraDragon =
    selectedCharacter.dragonOption && includeDragon
      ? DRAGON_PRICE
      : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacterIndex(
              Number(e.target.value)
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

```js 17:19
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  {
    name: "Danerys Targaryen",
    price: 16.5,
    dragonOption: true,
  },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [selectedCharacter, setSelectedCharacter] =
    useState(characters[0]);

  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const extraDragon =
    selectedCharacter.dragonOption && includeDragon
      ? DRAGON_PRICE
      : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacter(
              characters[Number(e.target.value)]
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

</Step>

<Step>

```diff 46:50

```

```diff 42:46

```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Estado Complejo: selectedCharacter + includeDragon">

```js 17:20
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  {
    name: "Danerys Targaryen",
    price: 16.5,
    dragonOption: true,
  },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [selectedCharacter, setSelectedCharacter] =
    useState(characters[0]);

  const [includeDragon, setIncludeDragon] = useState(false);

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const extraDragon =
    selectedCharacter.dragonOption && includeDragon
      ? DRAGON_PRICE
      : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);
  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select
          onChange={(e) =>
            setSelectedCharacter(
              characters[Number(e.target.value)]
            )
          }
        >
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={(e) =>
              setIncludeDragon(e.target.checked)
            }
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

```js 17:20,26:27 subtitle="character+dragon => Product"
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  {
    name: "Danerys Targaryen",
    price: 16.5,
    dragonOption: true,
  },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [selectedProduct, setSelectedProduct] = useState({
    character: characters[0],
    includeDragon: false,
  });

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const { character: selectedCharacter, includeDragon } =
    selectedProduct;
  const extraDragon =
    selectedCharacter.dragonOption && includeDragon
      ? DRAGON_PRICE
      : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);

  const handleCharacterSelected = (e) => {
    const selectedCharacter =
      characters[Number(e.target.value)];
    setSelectedProduct({
      character: selectedCharacter,
      includeDragon: false, //cada vez que cambiamos, reseteamos el complemento del dragon
    });
  };

  const handleWithDragonChanged = (e) => {
    setSelectedProduct({
      character: selectedProduct.character,
      includeDragon: e.target.checked,
    });
  };

  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select onChange={handleCharacterSelected}>
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={handleWithDragonChanged}
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

</Step>

<Step>

```diff 42:46

```

```diff 38:45,60 subtitle="encapsular handleEvent"

```

</Step>

<Step>

```diff 64:66

```

```diff 47:53,77 subtitle="encapsular handleEvent"

```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Hook useProduct">

```js 5:15 subtitle="Encapsulamos los datos"
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  {
    name: "Danerys Targaryen",
    price: 16.5,
    dragonOption: true,
  },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [selectedProduct, setSelectedProduct] = useState({
    character: characters[0],
    includeDragon: false,
  });

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const { character: selectedCharacter, includeDragon } =
    selectedProduct;
  const extraDragon =
    selectedCharacter.dragonOption && includeDragon
      ? DRAGON_PRICE
      : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);

  const handleCharacterSelected = (e) => {
    const selectedCharacter =
      characters[Number(e.target.value)];
    setSelectedProduct({
      character: selectedCharacter,
      includeDragon: false, //cada vez que cambiamos, reseteamos el complemento del dragon
    });
  };

  const handleWithDragonChanged = (e) => {
    setSelectedProduct({
      character: selectedProduct.character,
      includeDragon: e.target.checked,
    });
  };

  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select onChange={handleCharacterSelected}>
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={handleWithDragonChanged}
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

```js
...
```

</Step>

<Step title="Hook useProduct">

```js 4:7
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";
import {
  characters,
  DRAGON_PRICE,
} from "./model/characters";
import useProduct from "./hooks/useProduct";

const App = () => {
  const {
    product: selectedProduct,
    setProduct: setSelectedProduct,
    productPrice: selectedProductPrice,
  } = useProduct();

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const { character: selectedCharacter, includeDragon } =
    selectedProduct;

  const totalValue = selectedProductPrice * quantity;
  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);

  const handleCharacterSelected = (e) => {
    const selectedCharacter =
      characters[Number(e.target.value)];
    setSelectedProduct({
      character: selectedCharacter,
      includeDragon: false, //cada vez que cambiamos, reseteamos el complemento del dragon
    });
  };

  const handleIncludeDragonChanged = (e) => {
    setSelectedProduct({
      character: selectedProduct.character,
      includeDragon: e.target.checked,
    });
  };

  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select onChange={handleCharacterSelected}>
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={handleIncludeDragonChanged}
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

```js subtitle="en fichero de modelo"
// /model/characters.js

export const characters = [
  { name: "Jon Snow", price: 13.5 },
  {
    name: "Danerys Targaryen",
    price: 16.5,
    dragonOption: true,
  },
  { name: "Tyrion Lannister", price: 19 },
];
export const DRAGON_PRICE = 44.5;
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Hook useProduct">

```js 17:20,28:34 subtitle="estado + c√°lculo de producto"
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";

const characters = [
  { name: "Jon Snow", price: 13.5 },
  {
    name: "Danerys Targaryen",
    price: 16.5,
    dragonOption: true,
  },
  { name: "Tyrion Lannister", price: 19 },
];
const DRAGON_PRICE = 44.5;

const App = () => {
  const [selectedProduct, setSelectedProduct] = useState({
    character: characters[0],
    includeDragon: false,
  });

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const { character: selectedCharacter, includeDragon } =
    selectedProduct;
  const extraDragon =
    selectedCharacter.dragonOption && includeDragon
      ? DRAGON_PRICE
      : 0;
  const totalValue =
    (selectedCharacter.price + extraDragon) * quantity;

  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);

  const handleCharacterSelected = (e) => {
    const selectedCharacter =
      characters[Number(e.target.value)];
    setSelectedProduct({
      character: selectedCharacter,
      includeDragon: false, //cada vez que cambiamos, reseteamos el complemento del dragon
    });
  };

  const handleWithDragonChanged = (e) => {
    setSelectedProduct({
      character: selectedProduct.character,
      includeDragon: e.target.checked,
    });
  };

  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select onChange={handleCharacterSelected}>
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={handleWithDragonChanged}
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

```js
...
```

</Step>

<Step title="Hook useProduct">

```js 11:15,24
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";
import {
  characters,
  DRAGON_PRICE,
} from "./model/characters";
import useProduct from "./hooks/useProduct";

const App = () => {
  const {
    product: selectedProduct,
    setProduct: setSelectedProduct,
    productPrice: selectedProductPrice,
  } = useProduct();

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const { character: selectedCharacter, includeDragon } =
    selectedProduct;

  const totalValue = selectedProductPrice * quantity;
  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);

  const handleCharacterSelected = (e) => {
    const selectedCharacter =
      characters[Number(e.target.value)];
    setSelectedProduct({
      character: selectedCharacter,
      includeDragon: false, //cada vez que cambiamos, reseteamos el complemento del dragon
    });
  };

  const handleIncludeDragonChanged = (e) => {
    setSelectedProduct({
      character: selectedProduct.character,
      includeDragon: e.target.checked,
    });
  };

  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select onChange={handleCharacterSelected}>
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={handleIncludeDragonChanged}
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

```js subtitle="en fichero de hooks"
// /hooks/useProduct.js

import { useState } from "react";
import {
  characters,
  DRAGON_PRICE,
} from "../model/characters";

const useProduct = () => {
  const [product, setProduct] = useState({
    character: characters[0],
    includeDragon: false,
  });

  const extraDragon =
    product.character.dragonOption && product.includeDragon
      ? DRAGON_PRICE
      : 0;
  const productPrice =
    product.character.price + extraDragon;

  return {
    product,
    productPrice,
    setProduct,
  };
};
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Componente ProductSelector">

```js 28:42,48:73 subtitle="agrupamos la selecci√≥n de producto"
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";
import {
  characters,
  DRAGON_PRICE,
} from "./model/characters";
import useProduct from "./hooks/useProduct";

const App = () => {
  const {
    product: selectedProduct,
    setProduct: setSelectedProduct,
    productPrice: selectedProductPrice,
  } = useProduct();

  const [quantity, setQuantity] = useState(1);

  const { taxPercentage, country } = useTaxes();

  const { character: selectedCharacter, includeDragon } =
    selectedProduct;

  const totalValue = selectedProductPrice * quantity;
  const totalValueWithTaxes =
    totalValue + totalValue * (taxPercentage / 100);

  const handleCharacterSelected = (e) => {
    const selectedCharacter =
      characters[Number(e.target.value)];
    setSelectedProduct({
      character: selectedCharacter,
      includeDragon: false, //cada vez que cambiamos, reseteamos el complemento del dragon
    });
  };

  const handleIncludeDragonChanged = (e) => {
    setSelectedProduct({
      character: selectedProduct.character,
      includeDragon: e.target.checked,
    });
  };

  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <div>
        <label>Elige un personaje:</label>
        <select onChange={handleCharacterSelected}>
          {characters.map((character, index) => {
            return (
              <option
                key={character.name}
                value={index}
              >{`${character.name} (${character.price}‚Ç¨)`}</option>
            );
          })}
        </select>
      </div>

      {selectedCharacter.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={includeDragon}
            onChange={handleIncludeDragonChanged}
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

```js
...
```

</Step>

<Step title="Componente ProductSelector">

```js 24:27
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";
import useProduct from "./hooks/useProduct";
import ProductSelector from "./components/ProductSelector";

const App = () => {
  const {
    product: selectedProduct,
    setProduct: setSelectedProduct,
    productPrice: selectedProductPrice,
  } = useProduct();
  const [quantity, setQuantity] = useState(1);
  const { taxPercentage, country } = useTaxes();

  const totalPrice = selectedProductPrice * quantity;
  const totalPriceValueWithTaxes =
    totalPrice + totalPrice * (taxPercentage / 100);

  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <ProductSelector
        selectedProduct={selectedProduct}
        onProductSelected={setSelectedProduct}
      />

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalPriceValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};

export default App;
```

```js 1:56 subtitle="en un nuevo componente"
// /components/ProductSelector.js

import {
  characters,
  DRAGON_PRICE,
} from "../model/characters";
import PropTypes from "prop-types";

const ProductSelector = ({
  selectedProduct,
  onProductSelected,
}) => {
  const handleCharacterSelected = (e) => {
    const selectedCharacter =
      characters[Number(e.target.value)];
    onProductSelected({
      character: selectedCharacter,
      includeDragon: false, //cada vez que cambiamos, reseteamos el complemento del dragon
    });
  };

  const handleIncludeDragonChanged = (e) => {
    onProductSelected({
      character: selectedProduct.character,
      includeDragon: e.target.checked,
    });
  };

  return (
    <div>
      <label>Elige un personaje:</label>
      <select onChange={handleCharacterSelected}>
        {characters.map((character, index) => {
          return (
            <option
              key={character.name}
              value={index}
            >{`${character.name} (${character.price}‚Ç¨)`}</option>
          );
        })}
      </select>
      {selectedProduct.character.dragonOption && (
        <div>
          <input
            type="checkbox"
            checked={selectedProduct.includeDragon}
            onChange={handleIncludeDragonChanged}
          />
          <label htmlFor="dragon">
            Con drag√≥n en el hombro ({DRAGON_PRICE}‚Ç¨ m√°s)
          </label>
        </div>
      )}
    </div>
  );
};

ProductSelector.propTypes = {
  selectedProduct: PropTypes.shape({
    character: PropTypes.shape({
      name: PropTypes.string.isRequired,
      price: PropTypes.number.isRequired,
      dragonOption: PropTypes.bool,
    }),
    includeDragon: PropTypes.bool.isRequired,
  }),
  onProductSelected: PropTypes.func,
};

export default ProductSelector;
```

</Step>

</CodeSurferColumns>

---

<CodeSurferColumns>

<Step title="Repaso patr√≥n React ‚öõÔ∏è">

- Estados (useState)
- Efectos (useEffect)
- C√°lculos (Javascript)
- Render (JSX - data driven)

```js showNumbers
import { useState } from "react";
import "./App.css";
import useTaxes from "./hooks/useTaxes";
import useProduct from "./hooks/useProduct";
import ProductSelector from "./components/ProductSelector";

const App = () => {
  const {
    product: selectedProduct,
    setProduct: setSelectedProduct,
    productPrice: selectedProductPrice,
  } = useProduct();
  const [quantity, setQuantity] = useState(1);
  const { taxPercentage, country } = useTaxes();

  const totalPrice = selectedProductPrice * quantity;
  const totalPriceValueWithTaxes =
    totalPrice + totalPrice * (taxPercentage / 100);

  return (
    <>
      <h1>Calculadora de precios de mu√±ecos cabezones</h1>

      <ProductSelector
        selectedProduct={selectedProduct}
        onProductSelected={setSelectedProduct}
      />

      <div>
        <label htmlFor="quantity">Cantidad:</label>
        <input
          type="number"
          min="1"
          value={quantity}
          onChange={(e) =>
            setQuantity(Number(e.target.value))
          }
        />
      </div>

      <div>
        Impuesto: <span>{taxPercentage}%</span>
        <span>
          {country?.code && (
            <img
              width="16px"
              src={`https://flagsapi.com/${country.code}/flat/64.png`}
            />
          )}
        </span>
      </div>

      <div>
        Precio total:{" "}
        <span>{totalPriceValueWithTaxes.toFixed(2)}‚Ç¨</span>
      </div>
    </>
  );
};
```

</Step>

<Step title="Repaso patr√≥n React ‚öõÔ∏è">

- <span style="color:yellow">
    <i>
      <b>
        Estados (useState) + Efectos (useEffect) =>{" "}
        <ins>Custom Hooks</ins>
      </b>
    </i>
  </span>
- C√°lculos (Javascript)
- Render (JSX - data driven)

```diff 8:14

```

</Step>

<Step title="Repaso patr√≥n React ‚öõÔ∏è">

- Estados (useState) + Efectos (useEffect) => <ins>Custom Hooks</ins>
- <span style="color:yellow">
    <i>
      <b>C√°lculos (Javascript)</b>
    </i>
  </span>
- Render (JSX - data driven)

```diff 16:18

```

</Step>

<Step title="Repaso patr√≥n React ‚öõÔ∏è">

- Estados (useState) + Efectos (useEffect) => <ins>Custom Hooks</ins>
- √°lculos (Javascript)
- <span style="color:yellow">
    <i>
      <b>Render (JSX - data driven)</b>
    </i>
  </span>

```diff 21:57

```

</Step>

<Step title="Repaso patr√≥n React ‚öõÔ∏è">

- Estados (useState) + Efectos (useEffect) => <ins>Custom Hooks</ins>
- √°lculos (Javascript)
- <span style="color:yellow">
    <i>
      <b>
        Render (JSX - data driven) => <u>Componentes</u>
      </b>
    </i>
  </span>

```diff 24:27

```

</Step>

</CodeSurferColumns>
